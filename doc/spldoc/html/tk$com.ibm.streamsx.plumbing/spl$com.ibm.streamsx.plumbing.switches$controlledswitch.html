<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="SPL File controlledswitch.spl"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_compilationunit"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>SPL File controlledswitch.spl</title>
</head>
<body id="spldoc_compilationunit">


<h1 class="title topictitle1">SPL File <tt class="ph tt">controlledswitch.spl</tt></h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">streamsx.plumbing</a> &gt; <a class="xref" href="tk$com.ibm.streamsx.plumbing.html">com.ibm.streamsx.plumbing 0.3.0.__dev__</a> &gt; <a class="xref" href="ns$com.ibm.streamsx.plumbing.switches.html">com.ibm.streamsx.plumbing.switches</a> &gt; controlledswitch.spl</p>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Content</h2>
  
  <dl class="dl">
    <dt class="dt dlterm"/>
<dd class="dd"/>

    
      <dt class="dt dlterm splhead-2">Operators</dt>

      <dd class="dd">
<ul class="sl simple">
<li class="sli"><strong class="ph b"><a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__composite_operator__ControlledSwitch">ControlledSwitch</a></strong>: Controlled switch.
</li>

</ul>

      </dd>

    
    
      <dt class="dt dlterm splhead-2">Functions</dt>

      <dd class="dd">
<ul class="sl simple">
<li class="sli"><strong class="ph b"><a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function____initSwitch.rstring.boolean">__initSwitch(rstring, boolean)</a></strong>
</li>

<li class="sli"><strong class="ph b"><a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__getSwitchState.rstring">getSwitchState(rstring)</a></strong>: Get the state of a switch with control variable <tt class="ph tt">name</tt>.
</li>

<li class="sli"><strong class="ph b"><a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__registerSwitch.rstring.boolean">registerSwitch(rstring, boolean)</a></strong>: Register that an operator invocation will call <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__setSwitchState.rstring.boolean">setSwitchState(rstring, boolean)</a> or <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__getSwitchState.rstring">getSwitchState(rstring)</a>.
</li>

<li class="sli"><strong class="ph b"><a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__setSwitchState.rstring.boolean">setSwitchState(rstring, boolean)</a></strong>: Set the state of switches with control variable <tt class="ph tt">name</tt>.
</li>

</ul>

      </dd>

    
  </dl>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Composites</h2>
  
</div>

<div class="section" id="spldoc_compilationunit__composite_operator__ControlledSwitch"><h2 class="title sectiontitle splpart">composite ControlledSwitch(output OUT; input IN)</h2>
  
</div>

<div class="section">

<p class="p">Controlled switch.
</p>

<p class="p">A controlled version of the SPL Standard toolkit <tt class="ph tt">Switch</tt> operator. When the switch is closed (state is <tt class="ph tt">true</tt>) tuples on its input port flow through it its output port unchanged.
</p>

<p class="p">When the switch is open (state is <tt class="ph tt">false</tt>) tuples on its input port are blocked from flowing. Blocked tuples remain on the stream and will be submitted to the output stream once the switch is closed. Opening the switch can result in upstream processing being halted due to back pressure.
</p>

<p class="p">Operator invocations in the same job register an interest in controlling this switch by calling <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__registerSwitch.rstring.boolean">registerSwitch(rstring, boolean)</a> passing the name of this switch. Then the state of this switch is changed by calling <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__setSwitchState.rstring.boolean">setSwitchState(rstring, boolean)</a>.
</p>

<p class="p">A <tt class="ph tt">boolean</tt> control variable named <tt class="ph tt">name</tt> is created in the Job Control Plane which provides notifications and operations to control if the switch is open or closed. 
</p>

<p class="p">Multiple invocations of <tt class="ph tt">ControlledSwitch</tt> can share the same name and will then be controlled by the same control variable. Any call to <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__setSwitchState.rstring.boolean">setSwitchState(rstring, boolean)</a> sets the state of all switches with the same name.
</p>

<p class="p">In the case of failure the state of the switch is retained by the Job Control Plane.
</p>

<p class="p">Any application that invokes this operator must include a single invocation of the <tt class="ph tt">spl.control::JobControlPlane</tt> operator.
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">name</strong>: Name of the switch. 
</li>

<li class="sli"><strong class="ph b">initialState</strong>: This is an optional parameter of type boolean, which specifies if the Switch operator starts in the open (false -&gt; blocked) or closed (true -&gt; flowing) state. If not specified, the value is false. 
</li>

</ul>

</div>

<div class="section"><h2 class="title sectiontitle">Input Ports</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">IN</strong>: Input stream to be switched
</li>

</ul>

</div>

<div class="section"><h2 class="title sectiontitle">Output Ports</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">OUT</strong>: Output stream tuples are submitted to when the switch is closed
</li>

</ul>

</div>

<div class="section"><h2 class="title sectiontitle splhead-2">Composite Operator Graph</h2>
  
</div>

<div class="section splgraph">
  <embed class="image" src="../../image/tk$com.ibm.streamsx.plumbing/op$com.ibm.streamsx.plumbing.switches$ControlledSwitch.svg" width="252" height="114"/>
</div>

<div class="section"><h2 class="title sectiontitle splhead-2">SPL Source Code</h2>
  
</div>


<div class="section">
   <pre class="pre codeblock">

 public composite ControlledSwitch(input IN; output OUT)
 {
    param
         expression&lt;rstring&gt; $name;
         expression&lt;boolean&gt; $initialState : false;
     graph
 
         stream&lt;IN&gt; OUT = Switch(IN ; SwitchControl)
         {
             logic state: {boolean _dummy = __initSwitch($name, $initialState);}
             param
                 status : getSwitchState($name) ;
                 initialStatus: getSwitchState($name);
             config placement: partitionColocation(getThisCompositeInstanceName());
         }
         // this issues an attribute change notification which is then
         // sent to the Switch's control port. This will then call
         // getSwitchState() to set the switch to its correct state.
         stream&lt;MBeanNotificationBase&gt; SwitchControl = ControlVariableChange()
         {
             param
                 name : $name;
             config placement: partitionColocation(getThisCompositeInstanceName());
         }
 }

   </pre>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Functions</h2>
  
</div>

<div class="section" id="spldoc_compilationunit__function____initSwitch.rstring.boolean"><h2 class="title sectiontitle splpart">boolean __initSwitch(rstring name, boolean initialState)</h2>
  
</div>
<div class="section"><h2 class="title sectiontitle">Parameters</h2>

 <ul class="sl simple">
   <li class="sli">
<strong class="ph b">name</strong>
   </li>

   <li class="sli">
<strong class="ph b">initialState</strong>
   </li>

 </ul>

</div>

<div class="section"><h2 class="title sectiontitle">Returns</h2>

<ul class="sl simple"><li class="sli">
<tt class="ph tt">boolean</tt>
</li>
</ul>

</div>

<div class="section"><h2 class="title sectiontitle splhead-2">SPL Source Code</h2>
  
</div>

<div class="section">
   <pre class="pre codeblock">

 stateful boolean __initSwitch(rstring name, boolean initialState)
 {
 	return registerSwitch(name, initialState) ;
 }

   </pre>

</div>

<div class="section" id="spldoc_compilationunit__function__registerSwitch.rstring.boolean"><h2 class="title sectiontitle splpart">boolean registerSwitch(rstring name, boolean initialState)</h2>
  
</div>
<div class="section">

<p class="p">Register that an operator invocation will call <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__setSwitchState.rstring.boolean">setSwitchState(rstring, boolean)</a> or <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__getSwitchState.rstring">getSwitchState(rstring)</a>. A  shared <tt class="ph tt">boolean</tt> control variable is created with name <tt class="ph tt">name</tt>.
</p>

<p class="p">This function must be called in the <tt class="ph tt">logic state</tt> section of any operator invocation that calls <tt class="ph tt">setSwitchState</tt> or <tt class="ph tt">getSwitchState</tt>.
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

 <ul class="sl simple">
   <li class="sli">
<strong class="ph b">name</strong>
   </li>

   <li class="sli">
<strong class="ph b">initialState</strong>
   </li>

 </ul>

</div>

<div class="section"><h2 class="title sectiontitle">Returns</h2>

<ul class="sl simple"><li class="sli">
<tt class="ph tt">true</tt></li>
</ul>

</div>

<div class="section"><h2 class="title sectiontitle splhead-2">SPL Source Code</h2>
  
</div>

<div class="section">
   <pre class="pre codeblock">

 public stateful boolean registerSwitch(rstring name, boolean initialState)
 {
 	return createBooleanControlVariable(name, true, initialState) ;
 }

   </pre>

</div>

<div class="section" id="spldoc_compilationunit__function__setSwitchState.rstring.boolean"><h2 class="title sectiontitle splpart">void setSwitchState(rstring name, boolean on)</h2>
  
</div>
<div class="section">

<p class="p">Set the state of switches with control variable <tt class="ph tt">name</tt>. If <tt class="ph tt">on</tt> is <tt class="ph tt">true</tt> then the switch is closed. If <tt class="ph tt">on</tt> is <tt class="ph tt">false</tt> then the switch is open.
</p>

<p class="p">Any operator that invokes this must call <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__registerSwitch.rstring.boolean">registerSwitch(rstring, boolean)</a> in its <tt class="ph tt">logic state</tt> section, passing the same value for <tt class="ph tt">name</tt>.
</p>

<p class="p">Any operator may invoke this method to control <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__composite_operator__ControlledSwitch">ControlledSwitch</a> operator invocations within the same job, that were invoked with their parameter <tt class="ph tt">name</tt> set to <tt class="ph tt">name</tt>.
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

 <ul class="sl simple">
   <li class="sli">
<strong class="ph b">name</strong>: Name of the switch
   </li>

   <li class="sli">
<strong class="ph b">on</strong>: State to set the switch to.
   </li>

 </ul>

</div>

<div class="section">
</div>

<div class="section"><h2 class="title sectiontitle splhead-2">SPL Source Code</h2>
  
</div>

<div class="section">
   <pre class="pre codeblock">

 public stateful void setSwitchState(rstring name, boolean  on)
 {
 	setBooleanControlVariable(name, on) ;
 }

   </pre>

</div>

<div class="section" id="spldoc_compilationunit__function__getSwitchState.rstring"><h2 class="title sectiontitle splpart">boolean getSwitchState(rstring name)</h2>
  
</div>
<div class="section">

<p class="p">Get the state of a switch with control variable <tt class="ph tt">name</tt>.
</p>

<p class="p">Any operator that invokes this must call <a class="xref" href="spl$com.ibm.streamsx.plumbing.switches$controlledswitch.html#spldoc_compilationunit__function__registerSwitch.rstring.boolean">registerSwitch(rstring, boolean)</a> in its <tt class="ph tt">logic state</tt> section, passing the same value for <tt class="ph tt">name</tt>.
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

 <ul class="sl simple">
   <li class="sli">
<strong class="ph b">name</strong>: Name of the variable for the <tt class="ph tt">RandomLoadShedder</tt> operator invocation(s).
   </li>

 </ul>

</div>

<div class="section"><h2 class="title sectiontitle">Returns</h2>

<ul class="sl simple"><li class="sli">
<tt class="ph tt">boolean</tt>
</li>
</ul>

</div>

<div class="section"><h2 class="title sectiontitle splhead-2">SPL Source Code</h2>
  
</div>

<div class="section">
   <pre class="pre codeblock">

 public boolean getSwitchState(rstring name)
 {
 	return getBooleanControlVariable(name) ;
 }

   </pre>

</div>

</div>


</body>
</html>